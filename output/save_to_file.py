def save_to_txt(dictionary, filename, search_terms):
    tmp = {}
    for st in search_terms:
        tmp[st] = []

    for path in dictionary:
        for search_term, values in dictionary[path].items():
            for lib in values:
                tmp[search_term].append(lib)
    
    for st in search_terms:
        tmp[st] = list(set(tmp[st]))
        tmp[st].sort()

    file = open(filename.split('.')[0] + '.txt', "w")
    for st in search_terms:
        file.write(st + ':\n')
        for i in tmp[st]:
            if i != tmp[st][-1]: 
                file.write(i + ',\n')
            else:
                file.write(i + '\n')
    file.close()

def save_to_json(dictionary, filename, search_terms):
    file = open(filename.split('.')[0] + '.json', "w")
    file.write('{\n')

    last_key1 = list(dictionary.keys())[-1]

    for path in dictionary:
        file.write('\t"' + path + '": {\n')

        last_key2 = list(dictionary[path].keys())[-1]
        for search_term, values in dictionary[path].items():
            file.write('\t\t"' + search_term + '": [\n')
            for v in values:
                if v != values[-1]: 
                    file.write('\t\t\t"' + v + '",\n')
                else:
                    file.write('\t\t\t"' + v + '"\n')

            if search_term != last_key2:
                file.write('\t\t],\n')
            else:
                file.write('\t\t]\n')

        if path != last_key1:
            file.write('\t},\n')
        else:
            file.write('\t}\n')

    file.write('}')
    file.close()

def save_descriptions(dictionary, filename, search_terms):
    file = open(filename.split('.')[0] + '-descriptions.json', "w")
    file.write('{\n')

    last_key1 = list(dictionary.keys())[-1]

    for path in dictionary:
        file.write('\t"' + path + '": {\n')

        last_key2 = list(dictionary[path].keys())[-1]
        for search_term, values in dictionary[path].items():
            file.write('\t\t"' + search_term + '": [\n')
            for v in values:
                file.write('\t\t\t{\n')
                if v['description'] != "":
                    file.write('\t\t\t\t"id": "' + v['id'] + '",\n')
                    if 'group' in v and len(v['group']) > 0:
                        file.write('\t\t\t\t"description": "' + v['description'] + '",\n')
                    else:
                        file.write('\t\t\t\t"description": "' + v['description'] + '"\n')
                else:
                    file.write('\t\t\t\t"id": "' + v['id'] + '"\n')
                if 'group' in v and len(v['group']) > 0:
                    file.write('\t\t\t\t"group": [\n')

                    for g in v['group']:
                        file.write('\t\t\t\t\t{\n')
                        file.write('\t\t\t\t\t\t"id": "' + g['id'] + '",\n')
                        file.write('\t\t\t\t\t\t"description": "' + g['description'] + '"\n')

                        if g != v['group'][-1]: 
                            file.write('\t\t\t\t\t},\n')
                        else:
                            file.write('\t\t\t\t\t}\n')

                    file.write('\t\t\t\t]\n')

                if v != values[-1]: 
                    file.write('\t\t\t},\n')
                else:
                    file.write('\t\t\t}\n')

            if search_term != last_key2:
                file.write('\t\t],\n')
            else:
                file.write('\t\t]\n')

        if path != last_key1:
            file.write('\t},\n')
        else:
            file.write('\t}\n')

    file.write('}')
    file.close()

def save_frequency(ordered_distribution, filename, search_terms):
    file = open(filename.split('.')[0] + '-frequency.txt', "w")
    for search_term in ordered_distribution:
        file.write(search_term + ':\n')
        last_key = list(ordered_distribution[search_term].keys())[-1]

        for lib, sum in ordered_distribution[search_term].items():
            if lib != last_key: 
                file.write(lib + ': ' + str(sum) + ',\n')
            else:
                file.write(lib + ': ' + str(sum) + '\n')

    file.close()